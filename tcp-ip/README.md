# TCP/IP 내용 정리

### 연결 요청을 허용하는 소켓의 생성 과정 - server

1. 소켓의 생성 - socket()
2. IP와 PORT번호의 할당 - bind()
3. 연결 요청 가능 상태로 변경 - listen()
4. 연결 요청에 대한 수락 - accept()

### 연결 요청을 보내는 소켓의 생성 과정 - client

1. 소켓의 생성 - socket()
2. 목표 소켓과 연결 - connect()

<br>

**프로그램 컴파일 및 실행 (On linux)**
```text
gcc hello_server.c -o hserver // 컴파일 및 hserver(named) 프로그램 생성
./hserver 9190 // 9190 포트에서 hserver 프로그램 실행(요청 대기)

gcc hello_client -o hclient // 컴파일 및 hclient 프로그램 생성
./hclient 127.0.0.1 9190 // localhost의 9190 포트에 요청 전송
```

<br>

### 저수준(OS가 제공하는 시스템 함수를 사용한) 파일 입출력

- ANSI 표준 함수가 아닌, 운영체제가 제공하는 함수 기반의 파일 입출력이다.
- 표준이 아니며 운영 체제에 종속적이기 때문에, 다른 운영 체제와 호환되지 않는다.
- **리눅스는 소켓도 파일로 간주**기 때문에 저수준 파일 입출력 함수를 기반으로 소켓 기반 데이터 송수신이 가능하다.

### 파일 디스크립터 (파일 핸들, 소켓 핸들 ...)

- 운영체제가 만든 파일 또는 소켓을 구분하기 위한 일종의 숫자이다.
- 저수준 파일 입출력 함수는 입출력을 목적으로 파일 디스크립터를 요구한다.
- 저수준 파일 입출력 함수에게 소켓의 파일 디스크립터를 전달하면, 소켓을 대상으로 입출력을 진행한다.

|파일 디스크립터|대상|
|:---:|:---|
|0|표준 입력: Standard Input|
|1|표준 출력: Standard Output|
|2|표준 에러: Standard Error|

### 파일을 다루는 함수

- 파일 열기 - open()
- 파일 닫기 - close()
- 파일에 데이터 쓰기 - write()
- 파일에 저장된 데이터 읽기 - read()

|오픈 모드|의미|
|:---:|:---|
|`O_CREAT`|필요하면 파일을 생성|
|`O_TRUNC`|기존 데이터 전부 삭제|
|`O_APPEND`|기존 데이터 보관하고, 뒤에 이어서 저장|
|`O_RDONLY`|읽기 전용으로 파일 열기|
|`O_WRONLY`|쓰기 전용으로 파일 열기|
|`O_RDWR`|읽기, 쓰기 겸용으로 파일 열기|